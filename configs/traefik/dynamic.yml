http:
  routers:
    traefik:
      entryPoints: 
        - secure
      rule: Host(`dashboard.{{ env "ROOT_DOMAIN" }}`)
      service: api@internal
      middlewares:
        - allowFrames
      tls:
        certresolver: "le"
        domains:
          - main: {{ env "ROOT_DOMAIN" }}
            sans:
              - {{ $sans := env "ROOT_DOMAIN"}}"*.{{ $sans }}"

  middlewares:
    authelia:
      forwardAuth: 
        address: http://authelia:9091/api/verify?rd=https://logins.{{ env "ROOT_DOMAIN" }}
      trustForwardHeader: true
    guacamole:
      addPrefix:
        prefix: /guacamole
    allowFrames:
      headers:
          contentSecurityPolicy: frame-ancestors 'self' *.{{ env "ROOT_DOMAIN" }}
          stsIncludeSubdomains: true
          frameDeny: false